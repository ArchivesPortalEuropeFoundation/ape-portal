<?php return array (
  '406627aa80084665317dda8e561eb2b8' => 
  array (
    'criteria' => 
    array (
      'name' => 'moregallery',
    ),
    'object' => 
    array (
      'name' => 'moregallery',
      'path' => '{core_path}components/moregallery/',
      'assets_path' => '{assets_path}components/moregallery/',
    ),
  ),
  '08d157ff80fee513c9d6d9859fe1626f' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGalleryTemplate',
    ),
    'object' => 
    array (
      'id' => 12,
      'template_group' => 1,
      'name' => 'MoreGalleryTemplate',
      'description' => 'Policy Template for using the various MoreGallery features.',
      'lexicon' => 'moregallery:permissions',
    ),
  ),
  '1dcfd2f6c0afafe23a74f58a5ed22bf2' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_view_gallery',
    ),
    'object' => 
    array (
      'id' => 235,
      'template' => 12,
      'name' => 'moregallery_view_gallery',
      'description' => 'moregallery.permission.view_gallery',
      'value' => 1,
    ),
  ),
  '86f871e62fbadf6b3531dcca95338ffc' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_upload',
    ),
    'object' => 
    array (
      'id' => 236,
      'template' => 12,
      'name' => 'moregallery_upload',
      'description' => 'moregallery.permission.upload',
      'value' => 1,
    ),
  ),
  'f48118c9c798255a239a276958d5cfd1' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_import',
    ),
    'object' => 
    array (
      'id' => 237,
      'template' => 12,
      'name' => 'moregallery_import',
      'description' => 'moregallery.permission.import',
      'value' => 1,
    ),
  ),
  'cc549b57a48c2ccdacd1bf69ab427dc9' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_import_media',
    ),
    'object' => 
    array (
      'id' => 238,
      'template' => 12,
      'name' => 'moregallery_import_media',
      'description' => 'moregallery.permission.import_media',
      'value' => 1,
    ),
  ),
  'ca28fdbb81849816fb7071d964777f5f' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_video',
    ),
    'object' => 
    array (
      'id' => 239,
      'template' => 12,
      'name' => 'moregallery_video',
      'description' => 'moregallery.permission.video',
      'value' => 1,
    ),
  ),
  '04e2dab80cb0f4b6379ade5a066cb2fc' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_resource_settings',
    ),
    'object' => 
    array (
      'id' => 240,
      'template' => 12,
      'name' => 'moregallery_resource_settings',
      'description' => 'moregallery.permission.resource_settings',
      'value' => 1,
    ),
  ),
  '7523fcdfdf53aabc33dbf73070489bc3' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_image_active',
    ),
    'object' => 
    array (
      'id' => 241,
      'template' => 12,
      'name' => 'moregallery_image_active',
      'description' => 'moregallery.permission.image_active',
      'value' => 1,
    ),
  ),
  'af2c2438f4eb8fa9507198d5508b21aa' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_image_delete',
    ),
    'object' => 
    array (
      'id' => 242,
      'template' => 12,
      'name' => 'moregallery_image_delete',
      'description' => 'moregallery.permission.image_delete',
      'value' => 1,
    ),
  ),
  '5e030496392de14303a41da07c5d6f25' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_image_edit',
    ),
    'object' => 
    array (
      'id' => 243,
      'template' => 12,
      'name' => 'moregallery_image_edit',
      'description' => 'moregallery.permission.image_edit',
      'value' => 1,
    ),
  ),
  '3a6b44ffe49640583e52a629659c74b4' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_image_tags',
    ),
    'object' => 
    array (
      'id' => 244,
      'template' => 12,
      'name' => 'moregallery_image_tags',
      'description' => 'moregallery.permission.image_tags',
      'value' => 1,
    ),
  ),
  '04838390702b9fb18fb8447c729fdf50' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_image_tags_new',
    ),
    'object' => 
    array (
      'id' => 245,
      'template' => 12,
      'name' => 'moregallery_image_tags_new',
      'description' => 'moregallery.permission.image_tags_new',
      'value' => 1,
    ),
  ),
  'addfd6dbfa86a4b3de83af96075516b9' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'moregallery_image_crop_edit',
    ),
    'object' => 
    array (
      'id' => 246,
      'template' => 12,
      'name' => 'moregallery_image_crop_edit',
      'description' => 'moregallery.permission.image_crop_edit',
      'value' => 1,
    ),
  ),
  '68b98af006624b14c2ad6ef94e89a545' => 
  array (
    'criteria' => 
    array (
      'template' => 12,
      'name' => 'MoreGallery Full Access',
    ),
    'object' => 
    array (
      'id' => 15,
      'name' => 'MoreGallery Full Access',
      'description' => 'Access Policy for MoreGallery that includes all permissions. Overwritten on upgrade.',
      'parent' => 0,
      'template' => 12,
      'class' => '',
      'data' => '{"moregallery_image_active":true,"moregallery_image_crop_edit":true,"moregallery_image_delete":true,"moregallery_image_edit":true,"moregallery_image_tags":true,"moregallery_image_tags_new":true,"moregallery_import":true,"moregallery_import_media":true,"moregallery_resource_settings":true,"moregallery_upload":true,"moregallery_video":true,"moregallery_view_gallery":true}',
      'lexicon' => 'moregallery:permissions',
    ),
  ),
  '937065ea6fb6987577a3360846f4a764' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.source_relative_url',
    ),
    'object' => 
    array (
      'key' => 'moregallery.source_relative_url',
      'value' => 'assets/galleries/',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Storage',
      'editedon' => NULL,
    ),
  ),
  'a0e7a56f6bcfcda990d759de33d93ebb' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.source',
    ),
    'object' => 
    array (
      'key' => 'moregallery.source',
      'value' => '1',
      'xtype' => 'modx-combo-source',
      'namespace' => 'moregallery',
      'area' => 'Storage',
      'editedon' => NULL,
    ),
  ),
  'a3e155379256608d65794bccc45da378' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.image_id_in_name',
    ),
    'object' => 
    array (
      'key' => 'moregallery.image_id_in_name',
      'value' => 'prefix',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Storage',
      'editedon' => NULL,
    ),
  ),
  '76a0a181be47141b4749a1c111cd98bc' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.image_id_separator',
    ),
    'object' => 
    array (
      'key' => 'moregallery.image_id_separator',
      'value' => '_',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Storage',
      'editedon' => NULL,
    ),
  ),
  '88c0e8a455962588aaf68e9139c8d3a0' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.resource_id_in_path',
    ),
    'object' => 
    array (
      'key' => 'moregallery.resource_id_in_path',
      'value' => '1',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Storage',
      'editedon' => NULL,
    ),
  ),
  'e750a6974214d607b10f9d36b970db1a' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.content_position',
    ),
    'object' => 
    array (
      'key' => 'moregallery.content_position',
      'value' => 'above',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Interface',
      'editedon' => NULL,
    ),
  ),
  '3261ca364eb47fac042ee2a24879d82d' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.custom_fields',
    ),
    'object' => 
    array (
      'key' => 'moregallery.custom_fields',
      'value' => '{}',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Interface',
      'editedon' => NULL,
    ),
  ),
  'fe03cdd0e372528d8be92a635a59e4dd' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.use_rte_for_images',
    ),
    'object' => 
    array (
      'key' => 'moregallery.use_rte_for_images',
      'value' => '1',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Interface',
      'editedon' => NULL,
    ),
  ),
  'c0e9cf6ac0fe38eefc6ec66f15d5b156' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.prefill_from_iptc',
    ),
    'object' => 
    array (
      'key' => 'moregallery.prefill_from_iptc',
      'value' => '1',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => NULL,
    ),
  ),
  'b03df102f7b6ce793f81193fe1cc5324' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.vimeo_prefill_description',
    ),
    'object' => 
    array (
      'key' => 'moregallery.vimeo_prefill_description',
      'value' => '',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Video',
      'editedon' => NULL,
    ),
  ),
  '1dae2abb0c5eb806f8a2d48aacd0d755' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.vimeo_provide_referer',
    ),
    'object' => 
    array (
      'key' => 'moregallery.vimeo_provide_referer',
      'value' => '',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Video',
      'editedon' => NULL,
    ),
  ),
  'efc5a3adf8e06955d14bec876a5da9cd' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.youtube_prefill_description',
    ),
    'object' => 
    array (
      'key' => 'moregallery.youtube_prefill_description',
      'value' => '',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Video',
      'editedon' => NULL,
    ),
  ),
  'b17ea3e9e2f41f07eb90fe51fc62b5ba' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.prefetch_image_as_base64',
    ),
    'object' => 
    array (
      'key' => 'moregallery.prefetch_image_as_base64',
      'value' => '20',
      'xtype' => 'numberfield',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => NULL,
    ),
  ),
  'd6fec41e80d07f21b86ea0f94161935f' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.crops',
    ),
    'object' => 
    array (
      'key' => 'moregallery.crops',
      'value' => '',
      'xtype' => 'textarea',
      'namespace' => 'moregallery',
      'area' => 'Cropping',
      'editedon' => NULL,
    ),
  ),
  'b8fc1133e2f166f374a7d7aacb50743e' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.crop_jpeg_quality',
    ),
    'object' => 
    array (
      'key' => 'moregallery.crop_jpeg_quality',
      'value' => '100',
      'xtype' => 'numberfield',
      'namespace' => 'moregallery',
      'area' => 'Cropping',
      'editedon' => NULL,
    ),
  ),
  'd7766fe5ff87154710c390a513a95375' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.png_compression_level',
    ),
    'object' => 
    array (
      'key' => 'moregallery.png_compression_level',
      'value' => '9',
      'xtype' => 'numberfield',
      'namespace' => 'moregallery',
      'area' => 'Cropping',
      'editedon' => NULL,
    ),
  ),
  '12aa351bb042ff7535f10e078875cbdb' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.single_image_url_param',
    ),
    'object' => 
    array (
      'key' => 'moregallery.single_image_url_param',
      'value' => 'iid',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => NULL,
    ),
  ),
  '5725ba271a7219fa5eca1bb16352c656' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.allowed_extensions_per_source',
    ),
    'object' => 
    array (
      'key' => 'moregallery.allowed_extensions_per_source',
      'value' => '',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => NULL,
    ),
  ),
  '62487369d64d4a56a74d83eaf2131835' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.add_icon_to_toolbar',
    ),
    'object' => 
    array (
      'key' => 'moregallery.add_icon_to_toolbar',
      'value' => '1',
      'xtype' => 'modx-combo-boolean',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => NULL,
    ),
  ),
  '2a7674779d926331c31a807766e41eca' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.data_consent',
    ),
    'object' => 
    array (
      'key' => 'moregallery.data_consent',
      'value' => '0',
      'xtype' => 'numberfield',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => '2019-10-17 10:15:34',
    ),
  ),
  'a9af227bb230dea876cc62e228cddb13' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.sanitize_replace',
    ),
    'object' => 
    array (
      'key' => 'moregallery.sanitize_replace',
      'value' => '_',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Sanitize',
      'editedon' => NULL,
    ),
  ),
  'f7f0586053b4422e5cace0cda06d6bd0' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.sanitize_pattern',
    ),
    'object' => 
    array (
      'key' => 'moregallery.sanitize_pattern',
      'value' => '/([[:alnum:]_\\.-]*)/',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Sanitize',
      'editedon' => NULL,
    ),
  ),
  '7e79c023b6c0006d34d36d5864b24206' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.translit',
    ),
    'object' => 
    array (
      'key' => 'moregallery.translit',
      'value' => '',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Sanitize',
      'editedon' => NULL,
    ),
  ),
  'f7ca8920d3645a21caf9c0bbac330e26' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.translit_class',
    ),
    'object' => 
    array (
      'key' => 'moregallery.translit_class',
      'value' => '',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Sanitize',
      'editedon' => NULL,
    ),
  ),
  'eb1a499835f4e5b293b773e7a61eb20e' => 
  array (
    'criteria' => 
    array (
      'key' => 'moregallery.translit_class_path',
    ),
    'object' => 
    array (
      'key' => 'moregallery.translit_class_path',
      'value' => '',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Sanitize',
      'editedon' => NULL,
    ),
  ),
  'f96214e119eaccd16dde7e2a90c96e1b' => 
  array (
    'criteria' => 
    array (
      'key' => 'mgr_tree_icon_mgresource',
    ),
    'object' => 
    array (
      'key' => 'mgr_tree_icon_mgresource',
      'value' => 'icon-image',
      'xtype' => 'textfield',
      'namespace' => 'moregallery',
      'area' => 'Advanced',
      'editedon' => NULL,
    ),
  ),
  '90d93962ef3e98d6cc1b695d590930d3' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGallery_OnImageCreate',
    ),
    'object' => 
    array (
      'name' => 'MoreGallery_OnImageCreate',
      'service' => 6,
      'groupname' => 'moregallery',
    ),
  ),
  '4c0d795fc00d011d1f0f32022cef95b2' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGallery_OnImageRemove',
    ),
    'object' => 
    array (
      'name' => 'MoreGallery_OnImageRemove',
      'service' => 6,
      'groupname' => 'moregallery',
    ),
  ),
  '771af416d57e241eb389a4ba98734290' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGallery_OnTagCreate',
    ),
    'object' => 
    array (
      'name' => 'MoreGallery_OnTagCreate',
      'service' => 6,
      'groupname' => 'moregallery',
    ),
  ),
  '5723724d0249fb2c6c714ac9096ea456' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGallery_OnImageTagCreate',
    ),
    'object' => 
    array (
      'name' => 'MoreGallery_OnImageTagCreate',
      'service' => 6,
      'groupname' => 'moregallery',
    ),
  ),
  'acf70fdbb3372cdd5ee710fa7aad1019' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGallery_OnImageTagRemove',
    ),
    'object' => 
    array (
      'name' => 'MoreGallery_OnImageTagRemove',
      'service' => 6,
      'groupname' => 'moregallery',
    ),
  ),
  '30d7c9aa4ea225cb74393d695f473bc5' => 
  array (
    'criteria' => 
    array (
      'category' => 'MoreGallery',
    ),
    'object' => 
    array (
      'id' => 48,
      'parent' => 0,
      'category' => 'MoreGallery',
      'rank' => 0,
    ),
  ),
  '9af3a054ad91b5e150a4816bd119a6f0' => 
  array (
    'criteria' => 
    array (
      'name' => 'mgGetImages',
    ),
    'object' => 
    array (
      'id' => 105,
      'source' => 0,
      'property_preprocess' => 0,
      'name' => 'mgGetImages',
      'description' => 'Get images from a MoreGallery resource. (Part of MoreGallery)',
      'editor_type' => 0,
      'category' => 48,
      'cache_type' => 0,
      'snippet' => '/**
 * Gets the photos for the current (or specified) mgResource.
 *
 * @author Mark Hamstra for modmore <support@modmore.com>
 * @var modX $modx
 * @var array $scriptProperties
 */


/** @var moreGallery $moreGallery */
$corePath = $modx->getOption(\'moregallery.core_path\', null, $modx->getOption(\'core_path\') . \'components/moregallery/\');
$moreGallery = $modx->getService(\'moregallery\', \'moreGallery\', $corePath . \'model/moregallery/\');
if (!($moreGallery instanceof moreGallery) || !($moreGallery instanceof \\modmore\\Alpacka\\Alpacka)) {
    $modx->log(modX::LOG_LEVEL_ERROR, \'Error loading moreGallery class from \' . $corePath);
    return \'Error loading moreGallery class.\';
}

if (!method_exists($moreGallery, \'runSnippet\')) {
    $modx->log(modX::LOG_LEVEL_ERROR, \'[moreGallery] IMPORTANT! An older version of Alpacka is being used. Alpacka is a shared library used by numerous extras from modmore. MoreGallery 1.5+ requires Alpacka 0.3+, but an earlier version is loaded into memory. To resolve this issue, please make sure all extras from modmore are up to date (especially MoreGallery itself, ContentBlocks and SimpleCart) and that the Alpacka package is also installed and up to date. If the Alpacka package does not appear in your packages grid, you can download it from the modmore.com package provider for free.\');
    return \'<span style="color: red; background: white;">Error: using an old version of Alpacka. Please see the error log for more information.</span>\';
}

return $moreGallery->runSnippet(\'GetImages\', $scriptProperties, false);',
      'locked' => 0,
      'properties' => 'a:36:{s:5:"cache";a:7:{s:4:"name";s:5:"cache";s:4:"desc";s:34:"moregallery.mggetimages.cache_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"resource";a:7:{s:4:"name";s:8:"resource";s:4:"desc";s:37:"moregallery.mggetimages.resource_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:10:"activeOnly";a:7:{s:4:"name";s:10:"activeOnly";s:4:"desc";s:39:"moregallery.mggetimages.activeonly_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"sortBy";a:7:{s:4:"name";s:6:"sortBy";s:4:"desc";s:35:"moregallery.mggetimages.sortby_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:9:"sortorder";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:7:"sortDir";a:7:{s:4:"name";s:7:"sortDir";s:4:"desc";s:36:"moregallery.mggetimages.sortdir_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:3:"ASC";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:5:"where";a:7:{s:4:"name";s:5:"where";s:4:"desc";s:34:"moregallery.mggetimages.where_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:4:"tags";a:7:{s:4:"name";s:4:"tags";s:4:"desc";s:33:"moregallery.mggetimages.tags_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:11:"tagsFromUrl";a:7:{s:4:"name";s:11:"tagsFromUrl";s:4:"desc";s:40:"moregallery.mggetimages.tagsfromurl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:12:"tagSeparator";a:7:{s:4:"name";s:12:"tagSeparator";s:4:"desc";s:41:"moregallery.mggetimages.tagseparator_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:1:"
";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:7:"getTags";a:7:{s:4:"name";s:7:"getTags";s:4:"desc";s:36:"moregallery.mggetimages.gettags_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:18:"getResourceContent";a:7:{s:4:"name";s:18:"getResourceContent";s:4:"desc";s:47:"moregallery.mggetimages.getresourcecontent_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:21:"getResourceProperties";a:7:{s:4:"name";s:21:"getResourceProperties";s:4:"desc";s:50:"moregallery.mggetimages.getresourceproperties_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:17:"getResourceFields";a:7:{s:4:"name";s:17:"getResourceFields";s:4:"desc";s:46:"moregallery.mggetimages.getresourcefields_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"getResourceTVs";a:7:{s:4:"name";s:14:"getResourceTVs";s:4:"desc";s:43:"moregallery.mggetimages.getresourcetvs_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"tagTpl";a:7:{s:4:"name";s:6:"tagTpl";s:4:"desc";s:35:"moregallery.mggetimages.tagtpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:5:"mgtag";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"imageTpl";a:7:{s:4:"name";s:8:"imageTpl";s:4:"desc";s:37:"moregallery.mggetimages.imagetpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:7:"mgimage";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"mediaTpl";a:7:{s:4:"name";s:8:"mediaTpl";s:4:"desc";s:37:"moregallery.mggetimages.mediatpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:10:"youtubeTpl";a:7:{s:4:"name";s:10:"youtubeTpl";s:4:"desc";s:39:"moregallery.mggetimages.youtubetpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:9:"mgYoutube";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"vimeoTpl";a:7:{s:4:"name";s:8:"vimeoTpl";s:4:"desc";s:37:"moregallery.mggetimages.vimeotpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:7:"mgVimeo";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"imageSeparator";a:7:{s:4:"name";s:14:"imageSeparator";s:4:"desc";s:43:"moregallery.mggetimages.imageseparator_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:1:"
";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"singleImageTpl";a:7:{s:4:"name";s:14:"singleImageTpl";s:4:"desc";s:43:"moregallery.mggetimages.singleimagetpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:13:"mgimagesingle";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"singleMediaTpl";a:7:{s:4:"name";s:14:"singleMediaTpl";s:4:"desc";s:43:"moregallery.mggetimages.singlemediatpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:16:"singleYoutubeTpl";a:7:{s:4:"name";s:16:"singleYoutubeTpl";s:4:"desc";s:45:"moregallery.mggetimages.singleyoutubetpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:15:"mgYoutubeSingle";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"singleVimeoTpl";a:7:{s:4:"name";s:14:"singleVimeoTpl";s:4:"desc";s:43:"moregallery.mggetimages.singlevimeotpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:13:"mgVimeoSingle";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:18:"singleImageEnabled";a:7:{s:4:"name";s:18:"singleImageEnabled";s:4:"desc";s:47:"moregallery.mggetimages.singleimageenabled_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:16:"singleImageParam";a:7:{s:4:"name";s:16:"singleImageParam";s:4:"desc";s:45:"moregallery.mggetimages.singleimageparam_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:19:"singleImageResource";a:7:{s:4:"name";s:19:"singleImageResource";s:4:"desc";s:48:"moregallery.mggetimages.singleimageresource_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:10:"wrapperTpl";a:7:{s:4:"name";s:10:"wrapperTpl";s:4:"desc";s:39:"moregallery.mggetimages.wrappertpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"wrapperIfEmpty";a:7:{s:4:"name";s:14:"wrapperIfEmpty";s:4:"desc";s:43:"moregallery.mggetimages.wrapperifempty_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:13:"toPlaceholder";a:7:{s:4:"name";s:13:"toPlaceholder";s:4:"desc";s:42:"moregallery.mggetimages.toplaceholder_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:5:"limit";a:7:{s:4:"name";s:5:"limit";s:4:"desc";s:34:"moregallery.mggetimages.limit_desc";s:4:"type";s:11:"numberfield";s:7:"options";s:0:"";s:5:"value";i:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"offset";a:7:{s:4:"name";s:6:"offset";s:4:"desc";s:35:"moregallery.mggetimages.offset_desc";s:4:"type";s:11:"numberfield";s:7:"options";s:0:"";s:5:"value";i:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"totalVar";a:7:{s:4:"name";s:8:"totalVar";s:4:"desc";s:37:"moregallery.mggetimages.totalvar_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:5:"total";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"scheme";a:7:{s:4:"name";s:6:"scheme";s:4:"desc";s:35:"moregallery.mggetimages.scheme_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:5:"debug";a:7:{s:4:"name";s:5:"debug";s:4:"desc";s:34:"moregallery.mggetimages.debug_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"timing";a:7:{s:4:"name";s:6:"timing";s:4:"desc";s:35:"moregallery.mggetimages.timing_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}}',
      'moduleguid' => '',
      'static' => 0,
      'static_file' => '',
      'content' => '/**
 * Gets the photos for the current (or specified) mgResource.
 *
 * @author Mark Hamstra for modmore <support@modmore.com>
 * @var modX $modx
 * @var array $scriptProperties
 */


/** @var moreGallery $moreGallery */
$corePath = $modx->getOption(\'moregallery.core_path\', null, $modx->getOption(\'core_path\') . \'components/moregallery/\');
$moreGallery = $modx->getService(\'moregallery\', \'moreGallery\', $corePath . \'model/moregallery/\');
if (!($moreGallery instanceof moreGallery) || !($moreGallery instanceof \\modmore\\Alpacka\\Alpacka)) {
    $modx->log(modX::LOG_LEVEL_ERROR, \'Error loading moreGallery class from \' . $corePath);
    return \'Error loading moreGallery class.\';
}

if (!method_exists($moreGallery, \'runSnippet\')) {
    $modx->log(modX::LOG_LEVEL_ERROR, \'[moreGallery] IMPORTANT! An older version of Alpacka is being used. Alpacka is a shared library used by numerous extras from modmore. MoreGallery 1.5+ requires Alpacka 0.3+, but an earlier version is loaded into memory. To resolve this issue, please make sure all extras from modmore are up to date (especially MoreGallery itself, ContentBlocks and SimpleCart) and that the Alpacka package is also installed and up to date. If the Alpacka package does not appear in your packages grid, you can download it from the modmore.com package provider for free.\');
    return \'<span style="color: red; background: white;">Error: using an old version of Alpacka. Please see the error log for more information.</span>\';
}

return $moreGallery->runSnippet(\'GetImages\', $scriptProperties, false);',
    ),
  ),
  '9d6303674a50ac0e04e82b8dfefbda8c' => 
  array (
    'criteria' => 
    array (
      'name' => 'mgGetTags',
    ),
    'object' => 
    array (
      'id' => 106,
      'source' => 0,
      'property_preprocess' => 0,
      'name' => 'mgGetTags',
      'description' => 'Gets all tags, or all tags from a specific MoreGallery resource. (Part of MoreGallery)',
      'editor_type' => 0,
      'category' => 48,
      'cache_type' => 0,
      'snippet' => '/**
 * Gets tags for all or just the current resource.
 *
 * @author Mark Hamstra for modmore <support@modmore.com>
 * @var modX $modx
 * @var array $scriptProperties
 */

$scriptProperties = array_merge(array(
    \'cache\' => true,
    \'resource\' => \'\',
    \'sortBy\' => \'display\',
    \'sortDir\' => \'ASC\',
    \'where\' => \'\',

    \'tpl\' => \'mgtag\',
    \'separator\' => "\\n",
    \'wrapperTpl\' => \'\',
    \'wrapperIfEmpty\' => true,
    \'toPlaceholder\' => \'\',

    \'includeCount\' => false,

    \'totalVar\' => \'total\',
    \'limit\' => 0,
    \'offset\' => 0,
), $scriptProperties);
// Default to the current resource if none is set
if (!is_numeric($scriptProperties[\'resource\'])) {
    if ($modx->resource) { // but only if we have a resource
        $scriptProperties[\'resource\'] = $modx->resource->get(\'id\');
    }
}

/** @var moreGallery $moreGallery */
$corePath = $modx->getOption(\'moregallery.core_path\', null, $modx->getOption(\'core_path\') . \'components/moregallery/\');
$moreGallery = $modx->getService(\'moregallery\', \'moreGallery\', $corePath . \'model/moregallery/\');
if (!($moreGallery instanceof moreGallery)) {
    $modx->log(modX::LOG_LEVEL_ERROR, \'Error loading moreGallery class from \' . $corePath);
    return \'Error loading moreGallery class.\';
}

// Get (and set) the working context
$context = ($modx->context instanceof modContext) ? $modx->context->get(\'key\') : \'web\';
if ($scriptProperties[\'resource\'] > 0) {
    if ($modx->resource && $modx->resource->get(\'id\') == $scriptProperties[\'resource\']) {
        $context = $modx->resource->get(\'context_key\');
    }
    else {
        $resource = $modx->getObject(\'modResource\', (int)$scriptProperties[\'resource\']);
        if ($resource instanceof modResource) {
            $context = $resource->get(\'context_key\');
        }
    }
}
$moreGallery->setWorkingContext($context);

// Get caching related options
$cacheOptions = array(xPDO::OPT_CACHE_KEY => \'moregallery\');
$cacheKey = \'tags/r_\' . md5(serialize($scriptProperties));
$chunkHash = md5($moreGallery->getChunk($scriptProperties[\'tpl\'])) . md5($moreGallery->getChunk($scriptProperties[\'wrapperTpl\'], array(\'output\' => \'\')));

/**
 * Get from cache if we can
 */
if ($scriptProperties[\'cache\']) {
    $cached = $modx->cacheManager->get($cacheKey, $cacheOptions);
    if (is_array($cached)) {
        if ($chunkHash == $cached[\'chunkHash\']) {
            return $cached[\'formatted\'];
        }
    }
}

// Start the query to find tags
$c = $modx->newQuery(\'mgTag\');
$c->select($modx->getSelectColumns(\'mgTag\', \'mgTag\'));

// Limit results to a specific resource only?
if ($scriptProperties[\'resource\'] > 0) {
    $subc = $modx->newQuery(\'mgImageTag\');
    $subc->innerJoin(\'mgImage\', \'Image\');
    $subc->where(array(
        \'resource\' => $scriptProperties[\'resource\'],
        \'`tag` = mgTag.id\',
        \'Image.active\' => true,
    ));
    $subc->prepare();
    $c->where(\'EXISTS (\' . $subc->toSQL() . \')\');
}

// Include the image count?
if ($scriptProperties[\'includeCount\']) {
    $subc = $modx->newQuery(\'mgImageTag\');
    $subc->innerJoin(\'mgImage\', \'Image\');
    $subc->select(array(
        \'COUNT(Image.id) as image_count\'
    ));
    $subc->where(array(
        \'mgImageTag.tag = mgTag.id\',
        \'Image.active\' => true,
    ));
    if ($scriptProperties[\'resource\'] > 0) {
        $subc->where(array(
            \'Image.resource\' => $scriptProperties[\'resource\']
        ));
    }
    $subc->groupby(\'mgImageTag.tag\');

    $subc->prepare();
    $c->select(array(
        \'( \' . $subc->toSQL() . \' ) as image_count\'
    ));
}

// Any custom filter options?
if (!empty($scriptProperties[\'where\'])) {
    $where = $modx->fromJSON($scriptProperties[\'where\']);
    if (is_array($where))
    {
        $c->where($where);
    }
    else
    {
        $modx->log(modX::LOG_LEVEL_ERROR, \'&where property is not valid JSON: \' . $scriptProperties[\'where\'], \'\', \'mgGetTags\', __FILE__, __LINE__);
    }
}

// Sort it as specified
$c->sortby($scriptProperties[\'sortBy\'], $scriptProperties[\'sortDir\']);

// Get the number of results, and support getPage by setting a totalVar and limiting results as requested
$total = $modx->getCount(\'mgImage\', $c);
$modx->setPlaceholder($scriptProperties[\'totalVar\'], $total);
if ($scriptProperties[\'limit\'] > 0) {
    $c->limit($scriptProperties[\'limit\'], $scriptProperties[\'offset\']);
}

// Fetch the tags
$tags = array();
$i = 0;
/** @var mgTag $tag */
foreach ($modx->getIterator(\'mgTag\', $c) as $tag) {
    $tArray = $tag->toArray(\'\', false, true);
    $tArray[\'idx\'] = $i;
    $tArray[\'image_count\'] = empty($tArray[\'image_count\']) ? 0 : $tArray[\'image_count\'];
    $tags[] = $tArray;
    $i++;
}

$formatted = array();
foreach ($tags as $t) {
    $formatted[] = $moreGallery->getChunk($scriptProperties[\'tpl\'], $t);
}
$formatted = implode($scriptProperties[\'separator\'], $formatted);

if (!empty($scriptProperties[\'wrapperTpl\'])) {
    $formatted = $moreGallery->getChunk($scriptProperties[\'wrapperTpl\'], array(\'output\' => $formatted, \'tag_total\' => $total));
}

$cached = array(
    \'formatted\' => $formatted,
    \'chunkHash\' => $chunkHash,
    \'cached\' => date(\'c\'),
);
// Write to cache
$modx->cacheManager->set($cacheKey, $cached, 0, $cacheOptions);

if (!empty($scriptProperties[\'toPlaceholder\'])) {
    $modx->setPlaceholder($scriptProperties[\'toPlaceholder\'], $formatted);
} else {
    return $formatted;
}',
      'locked' => 0,
      'properties' => 'a:14:{s:5:"cache";a:7:{s:4:"name";s:5:"cache";s:4:"desc";s:32:"moregallery.mggettags.cache_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"resource";a:7:{s:4:"name";s:8:"resource";s:4:"desc";s:35:"moregallery.mggettags.resource_desc";s:4:"type";s:11:"numberfield";s:7:"options";s:0:"";s:5:"value";i:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"sortBy";a:7:{s:4:"name";s:6:"sortBy";s:4:"desc";s:33:"moregallery.mggettags.sortby_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:7:"display";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:7:"sortDir";a:7:{s:4:"name";s:7:"sortDir";s:4:"desc";s:34:"moregallery.mggettags.sortdir_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:3:"ASC";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:5:"where";a:7:{s:4:"name";s:5:"where";s:4:"desc";s:32:"moregallery.mggettags.where_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:3:"tpl";a:7:{s:4:"name";s:3:"tpl";s:4:"desc";s:30:"moregallery.mggettags.tpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:5:"mgtag";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:9:"separator";a:7:{s:4:"name";s:9:"separator";s:4:"desc";s:36:"moregallery.mggettags.separator_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:1:"
";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:10:"wrapperTpl";a:7:{s:4:"name";s:10:"wrapperTpl";s:4:"desc";s:37:"moregallery.mggettags.wrappertpl_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:14:"wrapperIfEmpty";a:7:{s:4:"name";s:14:"wrapperIfEmpty";s:4:"desc";s:41:"moregallery.mggettags.wrapperifempty_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:1;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:13:"toPlaceholder";a:7:{s:4:"name";s:13:"toPlaceholder";s:4:"desc";s:40:"moregallery.mggettags.toplaceholder_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:0:"";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:12:"includeCount";a:7:{s:4:"name";s:12:"includeCount";s:4:"desc";s:39:"moregallery.mggettags.includecount_desc";s:4:"type";s:13:"combo-boolean";s:7:"options";s:0:"";s:5:"value";b:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:8:"totalVar";a:7:{s:4:"name";s:8:"totalVar";s:4:"desc";s:35:"moregallery.mggettags.totalvar_desc";s:4:"type";s:9:"textfield";s:7:"options";s:0:"";s:5:"value";s:5:"total";s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:5:"limit";a:7:{s:4:"name";s:5:"limit";s:4:"desc";s:32:"moregallery.mggettags.limit_desc";s:4:"type";s:11:"numberfield";s:7:"options";s:0:"";s:5:"value";i:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}s:6:"offset";a:7:{s:4:"name";s:6:"offset";s:4:"desc";s:33:"moregallery.mggettags.offset_desc";s:4:"type";s:11:"numberfield";s:7:"options";s:0:"";s:5:"value";i:0;s:7:"lexicon";s:19:"moregallery:default";s:4:"area";s:0:"";}}',
      'moduleguid' => '',
      'static' => 0,
      'static_file' => '',
      'content' => '/**
 * Gets tags for all or just the current resource.
 *
 * @author Mark Hamstra for modmore <support@modmore.com>
 * @var modX $modx
 * @var array $scriptProperties
 */

$scriptProperties = array_merge(array(
    \'cache\' => true,
    \'resource\' => \'\',
    \'sortBy\' => \'display\',
    \'sortDir\' => \'ASC\',
    \'where\' => \'\',

    \'tpl\' => \'mgtag\',
    \'separator\' => "\\n",
    \'wrapperTpl\' => \'\',
    \'wrapperIfEmpty\' => true,
    \'toPlaceholder\' => \'\',

    \'includeCount\' => false,

    \'totalVar\' => \'total\',
    \'limit\' => 0,
    \'offset\' => 0,
), $scriptProperties);
// Default to the current resource if none is set
if (!is_numeric($scriptProperties[\'resource\'])) {
    if ($modx->resource) { // but only if we have a resource
        $scriptProperties[\'resource\'] = $modx->resource->get(\'id\');
    }
}

/** @var moreGallery $moreGallery */
$corePath = $modx->getOption(\'moregallery.core_path\', null, $modx->getOption(\'core_path\') . \'components/moregallery/\');
$moreGallery = $modx->getService(\'moregallery\', \'moreGallery\', $corePath . \'model/moregallery/\');
if (!($moreGallery instanceof moreGallery)) {
    $modx->log(modX::LOG_LEVEL_ERROR, \'Error loading moreGallery class from \' . $corePath);
    return \'Error loading moreGallery class.\';
}

// Get (and set) the working context
$context = ($modx->context instanceof modContext) ? $modx->context->get(\'key\') : \'web\';
if ($scriptProperties[\'resource\'] > 0) {
    if ($modx->resource && $modx->resource->get(\'id\') == $scriptProperties[\'resource\']) {
        $context = $modx->resource->get(\'context_key\');
    }
    else {
        $resource = $modx->getObject(\'modResource\', (int)$scriptProperties[\'resource\']);
        if ($resource instanceof modResource) {
            $context = $resource->get(\'context_key\');
        }
    }
}
$moreGallery->setWorkingContext($context);

// Get caching related options
$cacheOptions = array(xPDO::OPT_CACHE_KEY => \'moregallery\');
$cacheKey = \'tags/r_\' . md5(serialize($scriptProperties));
$chunkHash = md5($moreGallery->getChunk($scriptProperties[\'tpl\'])) . md5($moreGallery->getChunk($scriptProperties[\'wrapperTpl\'], array(\'output\' => \'\')));

/**
 * Get from cache if we can
 */
if ($scriptProperties[\'cache\']) {
    $cached = $modx->cacheManager->get($cacheKey, $cacheOptions);
    if (is_array($cached)) {
        if ($chunkHash == $cached[\'chunkHash\']) {
            return $cached[\'formatted\'];
        }
    }
}

// Start the query to find tags
$c = $modx->newQuery(\'mgTag\');
$c->select($modx->getSelectColumns(\'mgTag\', \'mgTag\'));

// Limit results to a specific resource only?
if ($scriptProperties[\'resource\'] > 0) {
    $subc = $modx->newQuery(\'mgImageTag\');
    $subc->innerJoin(\'mgImage\', \'Image\');
    $subc->where(array(
        \'resource\' => $scriptProperties[\'resource\'],
        \'`tag` = mgTag.id\',
        \'Image.active\' => true,
    ));
    $subc->prepare();
    $c->where(\'EXISTS (\' . $subc->toSQL() . \')\');
}

// Include the image count?
if ($scriptProperties[\'includeCount\']) {
    $subc = $modx->newQuery(\'mgImageTag\');
    $subc->innerJoin(\'mgImage\', \'Image\');
    $subc->select(array(
        \'COUNT(Image.id) as image_count\'
    ));
    $subc->where(array(
        \'mgImageTag.tag = mgTag.id\',
        \'Image.active\' => true,
    ));
    if ($scriptProperties[\'resource\'] > 0) {
        $subc->where(array(
            \'Image.resource\' => $scriptProperties[\'resource\']
        ));
    }
    $subc->groupby(\'mgImageTag.tag\');

    $subc->prepare();
    $c->select(array(
        \'( \' . $subc->toSQL() . \' ) as image_count\'
    ));
}

// Any custom filter options?
if (!empty($scriptProperties[\'where\'])) {
    $where = $modx->fromJSON($scriptProperties[\'where\']);
    if (is_array($where))
    {
        $c->where($where);
    }
    else
    {
        $modx->log(modX::LOG_LEVEL_ERROR, \'&where property is not valid JSON: \' . $scriptProperties[\'where\'], \'\', \'mgGetTags\', __FILE__, __LINE__);
    }
}

// Sort it as specified
$c->sortby($scriptProperties[\'sortBy\'], $scriptProperties[\'sortDir\']);

// Get the number of results, and support getPage by setting a totalVar and limiting results as requested
$total = $modx->getCount(\'mgImage\', $c);
$modx->setPlaceholder($scriptProperties[\'totalVar\'], $total);
if ($scriptProperties[\'limit\'] > 0) {
    $c->limit($scriptProperties[\'limit\'], $scriptProperties[\'offset\']);
}

// Fetch the tags
$tags = array();
$i = 0;
/** @var mgTag $tag */
foreach ($modx->getIterator(\'mgTag\', $c) as $tag) {
    $tArray = $tag->toArray(\'\', false, true);
    $tArray[\'idx\'] = $i;
    $tArray[\'image_count\'] = empty($tArray[\'image_count\']) ? 0 : $tArray[\'image_count\'];
    $tags[] = $tArray;
    $i++;
}

$formatted = array();
foreach ($tags as $t) {
    $formatted[] = $moreGallery->getChunk($scriptProperties[\'tpl\'], $t);
}
$formatted = implode($scriptProperties[\'separator\'], $formatted);

if (!empty($scriptProperties[\'wrapperTpl\'])) {
    $formatted = $moreGallery->getChunk($scriptProperties[\'wrapperTpl\'], array(\'output\' => $formatted, \'tag_total\' => $total));
}

$cached = array(
    \'formatted\' => $formatted,
    \'chunkHash\' => $chunkHash,
    \'cached\' => date(\'c\'),
);
// Write to cache
$modx->cacheManager->set($cacheKey, $cached, 0, $cacheOptions);

if (!empty($scriptProperties[\'toPlaceholder\'])) {
    $modx->setPlaceholder($scriptProperties[\'toPlaceholder\'], $formatted);
} else {
    return $formatted;
}',
    ),
  ),
  '19f328f31aa9a2dd82361478df3b6857' => 
  array (
    'criteria' => 
    array (
      'name' => 'MoreGallery',
    ),
    'object' => 
    array (
      'id' => 35,
      'source' => 0,
      'property_preprocess' => 0,
      'name' => 'MoreGallery',
      'description' => 'Registers CSS to the manager for proper display of the custom resource. (Part of MoreGallery)',
      'editor_type' => 0,
      'category' => 48,
      'cache_type' => 0,
      'plugincode' => '/**
 * @var modX $modx
 *
 * @event OnHandleRequest
 */

$assetsUrl = $modx->getOption(\'moregallery.assets_url\', null, $modx->getOption(\'assets_url\').\'components/moregallery/\');

switch ($modx->event->name) {
    case \'OnHandleRequest\':
        if ($modx->context && $modx->context instanceof modContext && $modx->context->get(\'key\') == \'mgr\') {
            $modx->regClientStartupHTMLBlock(\'<link rel="stylesheet" type="text/css" href="\' . $assetsUrl . \'mgr/css/moregallery.css\' . \'" />\');
        }
        break;

    case \'OnSiteRefresh\':
        $modx->getCacheManager()->clean(array(
            xPDO::OPT_CACHE_KEY => \'moregallery\'
        ));
        $modx->log(modX::LOG_LEVEL_INFO, \'Cleared MoreGallery cache\');

        break;

    case \'OnManagerPageBeforeRender\':
        /**
         * @var modManagerController $controller
         */
        // Load the moregallery lexicon
        $controller->addLexiconTopic(\'moregallery:default\');

        // If we\'re on at least 3.0, add a class to the page for improved styling
        $modxVersion = $modx->getVersionData();
        if (version_compare($modxVersion[\'full_version\'], \'3.0.0-dev\', \'>=\')) {
            $controller->addHtml(<<<HTML
<script type="text/javascript">
Ext.onReady(function() {
    Ext.getBody().addClass(\'moregallery_v30\');
});
</script>
HTML
            );
        }
        if (version_compare($modxVersion[\'full_version\'], \'2.3.0-dev\', \'>=\')) {
            $controller->addHtml(<<<HTML
<script type="text/javascript">
Ext.onReady(function() {
    Ext.getBody().addClass(\'moregallery_v23\');
});
</script>
HTML
            );
        }

        // Add the moregallery icon to the toolbar if requested
        if ($modx->getOption(\'moregallery.add_icon_to_toolbar\', null, true)) {
            $controller->addHtml(<<<HTML
<script>
var mgTreeToolbarInitiated = false;
Ext.onReady(function() {
    var tree = Ext.getCmp(\'modx-resource-tree\'),
        tb = (tree) ? tree.getTopToolbar() : false;
    if (!tb) return;

    if (!mgTreeToolbarInitiated) {
        mgTreeToolbarInitiated = true;
        setTimeout(function() {
            tb.insertButton(4, {
                cls: \'tree-new-gallery\',
                tooltip: _(\'moregallery.new\'),
                handler: function() {
                    var action = (MODx.action && MODx.action[\'resource/create\']) ? MODx.action[\'resource/create\'] : \'resource/create\';
                    MODx.loadPage(action, \'class_key=mgResource\');
                }
            });
            tb.doLayout();
        }, 500);
    }
});
</script>
HTML
            );
        }
    break;

    /**
     * @var string $path
     */
    case \'OnFileManagerFileRename\':
        $corePath = $modx->getOption(\'moregallery.core_path\', null, $modx->getOption(\'core_path\').\'components/moregallery/\');
        $moreGallery =& $modx->getService(\'moregallery\', \'moreGallery\' , $corePath . \'model/moregallery/\');
        $moreGallery->renames[] = $path;
        break;
}

return;',
      'locked' => 0,
      'properties' => NULL,
      'disabled' => 0,
      'moduleguid' => '',
      'static' => 0,
      'static_file' => '',
      'content' => '/**
 * @var modX $modx
 *
 * @event OnHandleRequest
 */

$assetsUrl = $modx->getOption(\'moregallery.assets_url\', null, $modx->getOption(\'assets_url\').\'components/moregallery/\');

switch ($modx->event->name) {
    case \'OnHandleRequest\':
        if ($modx->context && $modx->context instanceof modContext && $modx->context->get(\'key\') == \'mgr\') {
            $modx->regClientStartupHTMLBlock(\'<link rel="stylesheet" type="text/css" href="\' . $assetsUrl . \'mgr/css/moregallery.css\' . \'" />\');
        }
        break;

    case \'OnSiteRefresh\':
        $modx->getCacheManager()->clean(array(
            xPDO::OPT_CACHE_KEY => \'moregallery\'
        ));
        $modx->log(modX::LOG_LEVEL_INFO, \'Cleared MoreGallery cache\');

        break;

    case \'OnManagerPageBeforeRender\':
        /**
         * @var modManagerController $controller
         */
        // Load the moregallery lexicon
        $controller->addLexiconTopic(\'moregallery:default\');

        // If we\'re on at least 3.0, add a class to the page for improved styling
        $modxVersion = $modx->getVersionData();
        if (version_compare($modxVersion[\'full_version\'], \'3.0.0-dev\', \'>=\')) {
            $controller->addHtml(<<<HTML
<script type="text/javascript">
Ext.onReady(function() {
    Ext.getBody().addClass(\'moregallery_v30\');
});
</script>
HTML
            );
        }
        if (version_compare($modxVersion[\'full_version\'], \'2.3.0-dev\', \'>=\')) {
            $controller->addHtml(<<<HTML
<script type="text/javascript">
Ext.onReady(function() {
    Ext.getBody().addClass(\'moregallery_v23\');
});
</script>
HTML
            );
        }

        // Add the moregallery icon to the toolbar if requested
        if ($modx->getOption(\'moregallery.add_icon_to_toolbar\', null, true)) {
            $controller->addHtml(<<<HTML
<script>
var mgTreeToolbarInitiated = false;
Ext.onReady(function() {
    var tree = Ext.getCmp(\'modx-resource-tree\'),
        tb = (tree) ? tree.getTopToolbar() : false;
    if (!tb) return;

    if (!mgTreeToolbarInitiated) {
        mgTreeToolbarInitiated = true;
        setTimeout(function() {
            tb.insertButton(4, {
                cls: \'tree-new-gallery\',
                tooltip: _(\'moregallery.new\'),
                handler: function() {
                    var action = (MODx.action && MODx.action[\'resource/create\']) ? MODx.action[\'resource/create\'] : \'resource/create\';
                    MODx.loadPage(action, \'class_key=mgResource\');
                }
            });
            tb.doLayout();
        }, 500);
    }
});
</script>
HTML
            );
        }
    break;

    /**
     * @var string $path
     */
    case \'OnFileManagerFileRename\':
        $corePath = $modx->getOption(\'moregallery.core_path\', null, $modx->getOption(\'core_path\').\'components/moregallery/\');
        $moreGallery =& $modx->getService(\'moregallery\', \'moreGallery\' , $corePath . \'model/moregallery/\');
        $moreGallery->renames[] = $path;
        break;
}

return;',
    ),
  ),
  '43073189c48a4cbfd05b07443fff13d0' => 
  array (
    'criteria' => 
    array (
      'pluginid' => 35,
      'event' => 'OnHandleRequest',
    ),
    'object' => 
    array (
      'pluginid' => 35,
      'event' => 'OnHandleRequest',
      'priority' => 0,
      'propertyset' => 0,
    ),
  ),
  '6476d115c530e843e79af36839a87454' => 
  array (
    'criteria' => 
    array (
      'pluginid' => 35,
      'event' => 'OnManagerPageBeforeRender',
    ),
    'object' => 
    array (
      'pluginid' => 35,
      'event' => 'OnManagerPageBeforeRender',
      'priority' => 0,
      'propertyset' => 0,
    ),
  ),
  'b29b8233a0070bef8a5b8f45c5b11b13' => 
  array (
    'criteria' => 
    array (
      'pluginid' => 35,
      'event' => 'OnSiteRefresh',
    ),
    'object' => 
    array (
      'pluginid' => 35,
      'event' => 'OnSiteRefresh',
      'priority' => 0,
      'propertyset' => 0,
    ),
  ),
  'cfcf559452ae3b2f7bfdae6486888353' => 
  array (
    'criteria' => 
    array (
      'pluginid' => 35,
      'event' => 'OnFileManagerFileRename',
    ),
    'object' => 
    array (
      'pluginid' => 35,
      'event' => 'OnFileManagerFileRename',
      'priority' => 0,
      'propertyset' => 0,
    ),
  ),
);