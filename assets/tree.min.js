"undefined"!=typeof enable_tree&&(!function(e,$,o){var t="asi-ajax/?action=load_tree",a="asi-ajax/?action=load_tree_siblings",r="asi-ajax/?action=load_tree_children",l="asi-ajax/?action=load_archive_detail";e.page_request_params={},e.init=function(){e.page_request_params=function(o){o=o.split("+").join(" ");for(var t,a={},r=/[?&]?([^=]+)=([^&]*)/g;t=r.exec(o);){var l=decodeURIComponent(t[1]),n=decodeURIComponent(t[2]);if("[]"==l.substring(l.length-2)){var s=l.substring(0,l.length-2);Array.isArray(a[s])||(a[s]=new Array),a[s].push(n),e.page_request_params[s]=a[s]}else a[l]=n}return a}(document.location.search),console.log(e.page_request_params),$.ajax({method:"GET",url:t+"&c="+e.page_request_params.c+"&recordId="+e.page_request_params.recordId+"&start=0"}).done((function(e){var o=JSON.parse(e);$('[data-populate="tree"]').html(o.result)})),$('[data-populate="tree"]').on("click",'[data-trigger="load_tree_siblings"]',(function(e){var o=$(this),t=$(this).parent("ul").parent("li"),r=$(this).parent("ul"),l=t.attr("data-id"),n=o.attr("data-direction"),s=o.attr("data-position");e.stopPropagation(),$.ajax({method:"GET",url:a+"&parent_id="+l+"&direction="+n+"&position="+s}).done((function(e){var t=JSON.parse(e);"UP"==n?r.prepend(t.result):r.append(t.result),o.remove()}))})),$('[data-populate="tree"]').on("click",'[data-trigger="load_tree_children"]',(function(o){if($(o.target).is("i")&&$(this).hasClass("open"))return $(this).removeClass("open"),$(this).addClass("been-collapsed"),void o.stopPropagation();console.log("loading children...");var t=$(this),a=t.attr("data-id");o.stopPropagation(),1!=$(this).hasClass("open")||1!=$(this).hasClass("been-collapsed")?$.ajax({method:"GET",url:r+"&parent_id="+a}).done((function(e){var o=JSON.parse(e);t.append(o.result.children),t.addClass("open")})):console.log("The children of this node have already been loaded, just loading the detail..."),console.log(l+"&recordId="+e.page_request_params.recordId+"&c="+a),$.ajax({method:"GET",url:l+"&recordId="+e.page_request_params.recordId+"&c="+a}).done((function(e){var o=JSON.parse(e);console.log(o.result),console.log(o.result.eadId),$('[data-populate="archive_detail_rhs"]').html(o.result.rhs),$('[data-populate="archive_detail_top_left"]').html(o.result.top_left),$('[data-populate="archive_detail_top"]').html(o.result.top),this.repoCode=o.result.repoCode,this.recordId=o.result.recordId,eadId=o.result.eadId,clevelId=o.result.clevelId,unitId=o.result.unitId,levelName=o.result.levelName,treeId=o.result.treeId,type=o.result.type,max=o.result.limit,compCurrentPg=o.result.page,compResultsTotal=o.result.resultsTotal,compPageTotal=o.result.pageTotal,function(e){console.log(repoCode),console.log(recordId);var o=`${conf.component_endpoint}&page=${e}&repositoryCode=${repoCode}&levelName=${levelName}&recordId=${recordId}&type=${type}`;console.log(o),clevelId&&(o+=`&c=C${clevelId}`),unitId&&(o+=`&unitId=${unitId}`),console.log(o),console.log(e),$(document).find("#componentChildren").css("opacity","0.3"),$.ajax({method:"GET",url:o,context:this,dataType:"json"}).done((function(e){console.log("Here"),console.log(compOptions),console.log(parseInt(e.result.page)),console.log(e.result.pageTotal),compOptions.currentPage=parseInt(e.result.page),compOptions.totalPages=e.result.pageTotal,$("#componentChildren").html(e.result.html),console.log("Loaded HTML to componentChildren"),compOptions.totalPages>1?($("#componentChildren").show(),$("#ComponentsPagination").bootstrapPaginator(this.compOptions)):$("#componentChildren").hide(),$(document).find("#componentChildren").css("opacity","1"),$(document).find("#componentChildren").show(),console.log(e)})).fail((function(e){console.log(e)})).always((function(){console.log("Always")}))}(1)}))}))}}(window.ApeTree=window.ApeTree||{},jQuery),ApeTree.init());
//# sourceMappingURL=tree.min.js.map